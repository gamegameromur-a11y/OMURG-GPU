name: Build Android Final
on:
  push:
    branches:
      - main
      - master
  workflow_dispatch: # Manuel baÅŸlat butonu

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # 1. KodlarÄ± Ã‡ek
      - name: ğŸ— Checkout Repository
        uses: actions/checkout@v4

      # 2. Node.js Kur (Cache ayarÄ±nÄ± kapattÄ±k ki hata vermesin)
      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18

      # 3. KÃ¼tÃ¼phaneleri ve EAS CLI'yi YÃ¼kle
      - name: ğŸ“¦ Install Dependencies & EAS
        run: |
          npm install
          npm install -g eas-cli

      # 4. Expo YapÄ±landÄ±rmasÄ± ve Build (Hata korumalÄ±)
      - name: ğŸš€ Configure & Build
        env:
          EXPO_TOKEN: ${{ secrets.EXPO_TOKEN }}
          EXPO_PROJECT_ID: ${{ secrets.EXPO_PROJECT_ID }}
        run: |
          echo "EAS CLI Version:"
          npx eas-cli --version
          
          # Projeyi ID ile baÄŸla (Zaten baÄŸlÄ±ysa hata vermez, devam eder)
          npx eas-cli init --id $EXPO_PROJECT_ID --non-interactive || true
          
          # Build iÅŸlemini baÅŸlat
          npx eas-cli build --platform android --profile production --non-interactive
